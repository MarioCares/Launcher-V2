unit MainWindow;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls,
  Forms, Dialogs, StdCtrls, ActnList, ComCtrls, ExtCtrls, Menus,
  HotKeyManager, xmldom, Xmlxform, XMLIntf, msxmldom, XMLDoc, ShellAPI;

type
  TForm1 = class(TForm)
    edit_programa: TEdit;
    TrayIcon1: TTrayIcon;
    PopupMenu1: TPopupMenu;
    Mostrar1: TMenuItem;
    Ocultar1: TMenuItem;
    Cerrar1: TMenuItem;
    procedure fijarVentana(Sender: TObject);
    procedure mostrarVentana();
    procedure ocultarVentana();
  private
    var abierto: Boolean;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

  procedure TForm1.fijarVentana(Sender: TObject);
    begin
      Form1.Left := Round(Screen.Width/2 - Form1.Width/2); Form1.Top := 5;
      ShowWindow(application.Handle, SW_HIDE)
    end;

  procedure TForm1.ocultarVentana();
    begin
      Application.ShowMainForm := False;
      Form1.Visible := False;
      abierto := not abierto;
    end;

  procedure Tform1.mostrarVentana();
    begin
      Application.ShowMainForm := True;
      Application.Restore;
      SetForegroundWindow(Self.Handle);
      Form1.Show;
      Form1.Visible := True;
      abierto := not abierto;
    end;

end.
